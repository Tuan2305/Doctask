<!-- src/app/components/notification-popover/notification-popover.component.html -->
<div class="notification-trigger">
  <nz-badge [nzCount]="unreadNotificationCount" [nzShowZero]="false" class="notification-badge">
    <div class="notification-icon-container" (click)="openNotificationModal()">
      <span nz-icon nzType="bell" nzTheme="outline" class="notification-icon"></span>
    </div>
  </nz-badge>
</div>

<!-- Notification Modal -->
<nz-modal
  [(nzVisible)]="isModalVisible"
  nzTitle="Thông báo"
  [nzFooter]="null"
  (nzOnCancel)="closeNotificationModal()"
  nzWidth="420px"
  nzClassName="notification-modal"
  [nzBodyStyle]="{ padding: '0' }">

  <ng-container *nzModalContent>
    <div class="notification-modal-content">
      <!-- Header -->
      <div class="notification-header">
        <div class="header-title">
          <h3>Thông báo</h3>
          <span class="notification-count" *ngIf="unreadNotificationCount > 0">
            {{ unreadNotificationCount }} mới
          </span>
        </div>
        <div class="header-actions">
          <button 
            nz-button 
            nzType="text" 
            nzSize="small"
            (click)="markAllAsRead()"
            *ngIf="unreadNotificationCount > 0">
            Đánh dấu tất cả đã đọc
          </button>
        </div>
      </div>

      <nz-divider ></nz-divider>

      <!-- Notification List -->
      <div class="notification-list">
        <ng-container *ngIf="notifications.length > 0; else noNotifications">
          <div 
            *ngFor="let notification of notifications" 
            class="notification-item"
            [class.unread]="!notification.isRead"
            (click)="onNotificationClick(notification)">
            
            <div class="notification-avatar">
              <nz-avatar nzIcon="bell" [nzSize]="40"></nz-avatar>
              <div class="unread-indicator" *ngIf="!notification.isRead"></div>
            </div>
            
            <div class="notification-content">
              <div class="notification-message">{{ notification.message }}</div>
              <div class="notification-time">{{ getTimeAgo(notification.createdAt) }}</div>
            </div>
            
            <div class="notification-actions">
              <button 
                nz-button 
                nzType="text" 
                nzSize="small"
                nz-tooltip="Đánh dấu đã đọc"
                (click)="markAsRead(notification.notificationId, $event)"
                *ngIf="!notification.isRead"
                class="action-btn read-btn">
                <span nz-icon nzType="check"></span>
              </button>
              
              <button 
                nz-button 
                nzType="text" 
                nzSize="small"
                nz-tooltip="Xóa thông báo"
                (click)="deleteNotification(notification.notificationId, $event)"
                class="action-btn delete-btn">
                <span nz-icon nzType="close"></span>
              </button>
            </div>
          </div>
        </ng-container>

        <ng-template #noNotifications>
          <div class="empty-notifications">
            <nz-empty 
              nzText="Không có thông báo nào"
              [nzNotFoundImage]="'simple'">
            </nz-empty>
          </div>
        </ng-template>
      </div>

      <!-- Footer -->
      <div class="notification-footer" *ngIf="notifications.length > 5">
        <button nz-button nzType="text" nzBlock>
          Xem tất cả thông báo
        </button>
      </div>
    </div>
  </ng-container>
</nz-modal>